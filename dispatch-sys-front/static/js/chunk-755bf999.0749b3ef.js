(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-755bf999"],{3663:function(e,t,i){"use strict";var a=i("83a9"),l=i.n(a);l.a},"83a9":function(e,t,i){},b45f:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"title-column"},[i("i",{staticClass:"icon iconfont icon-tubiaozhizuo-"}),e._v(" "),i("span",[e._v(e._s(e.$t("pageTitle.AddDevice")))])]),e._v(" "),i("div",{staticClass:"list-container-device"},[i("el-form",{ref:"form",staticClass:"device-form",attrs:{model:e.form,rules:e.formRules,"label-width":"100px"}},[i("el-form-item",{staticClass:"device-input",attrs:{label:"设备类型",prop:"vehicleTypeId"}},[i("el-select",{staticClass:"select",on:{"visible-change":e.changeVehicleType},model:{value:e.form.vehicleTypeId,callback:function(t){e.$set(e.form,"vehicleTypeId",t)},expression:"form.vehicleTypeId"}},e._l(e.vehicleTypeId,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),i("el-form-item",{staticClass:"device-input",attrs:{label:"设备型号",prop:"modelId"}},[i("el-select",{staticClass:"select",attrs:{filterable:""},model:{value:e.form.modelId,callback:function(t){e.$set(e.form,"modelId",t)},expression:"form.modelId"}},e._l(e.modelId,(function(t,a){return i("el-option",{key:a,attrs:{label:t.name,value:t.id}},[i("div",{staticClass:"labelIndex"},[e._v(e._s(a+1))]),e._v(" "),i("span",[e._v(e._s(t.name))])])})),1)],1),e._v(" "),i("el-form-item",{staticClass:"device-input",attrs:{label:"协议类型",prop:"protocol"}},[i("el-select",{staticClass:"select",model:{value:e.form.protocol,callback:function(t){e.$set(e.form,"protocol",t)},expression:"form.protocol"}},e._l(e.protocol,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),i("el-form-item",{ref:"name",staticClass:"device-input",attrs:{label:"设备名称",prop:"name"}},[i("el-input",{attrs:{placeholder:"输入设备名称",maxlength:"20"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),i("el-form-item",{ref:"mac",staticClass:"device-input",attrs:{label:"Mac地址",prop:"mac"}},[i("el-input",{attrs:{placeholder:"格式：00:01:6C:06:A6:28",maxlength:"17",id:"macInput",readonly:!e.isChangeMac},on:{input:e.changeMac},model:{value:e.form.mac,callback:function(t){e.$set(e.form,"mac","string"===typeof t?t.trim():t)},expression:"form.mac"}})],1),e._v(" "),i("el-form-item",{staticClass:"device-input",attrs:{label:"工作区域",prop:"domainId"}},[i("el-select",{staticClass:"select",model:{value:e.form.domainId,callback:function(t){e.$set(e.form,"domainId",t)},expression:"form.domainId"}},e._l(e.workSpaceList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),i("el-form-item",{staticClass:"btns"},[i("div",{staticClass:"list"},[i("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline",loading:e.loading},on:{click:e.addForm}},[e._v(e._s(e.$t("pageTitle.confirm")))]),e._v(" "),i("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-delete"},on:{click:function(t){return e.resetForm("form")}}},[e._v(e._s(e.$t("pageTitle.EmptyTaskLines")))])],1)])],1)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.visible,width:"300px",center:""},on:{"update:visible":function(t){e.visible=t}}},[i("div",{staticClass:"del-dialog-cnt"},[i("i",{staticClass:"el-icon-success"}),e._v(" "),i("div",{staticClass:"text"},[e._v(e._s(e.$t("pageTitle.AddFormSuccess")))])]),e._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){return e.leftBtn("deviceList")}}},[e._v(e._s(e.$t("pageTitle.ViewList")))]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.rightBtn}},[e._v(e._s(e.$t("pageTitle.ContinueToAddForm")))])],1)])],1)},l=[],n=(i("ac6a"),i("7f7f"),i("a481"),i("db72")),o=i("b199"),s=i("aa98"),c=i("9659"),r=i("2f62"),d={computed:Object(n["a"])({},Object(r["b"])(["dialogShow"])),data:function(){var e=function(e,t,i){Object(c["i"])(t,i)};return{changeSelect:!1,visible:!1,loading:!1,dialogInfo:{show:!1,icon:"",dialogText:"",leftBtnText:"",rightBtnText:""},form:{name:"",modelId:"",vehicleTypeId:"",protocol:"",mac:"",domainId:""},formRules:{mac:[{required:!0,trigger:"blur",validator:e}],domainId:[{required:!0,message:"请选择工作区域",trigger:"change"}],name:[{required:!0,message:"请输入设备名称",trigger:"blur"}],protocol:[{required:!0,message:"请选择协议类型",trigger:"change"}],modelId:[{required:!0,message:"请选择设备型号",trigger:"change"}],vehicleTypeId:[{required:!0,message:"请选择设备类型",trigger:"change"}]},workSpaceList:[],vehicleTypeId:[],modelId:[],protocol:[{name:"lanxincn",id:"lanxincn"}],oldMacAddr:"",isChangeMac:!0}},created:function(){var e=this;Object(s["A"])().then((function(t){e.getOptions(t,"name",e.vehicleTypeId),Object(s["w"])(t[0].id).then((function(t){e.getOptions(t,"modelName",e.modelId)}))})),Object(o["n"])().then((function(t){e.workSpaceList=t}))},methods:{changeMac:function(){var e=this;if(this.isChangeMac){this.isChangeMac=!1;var t=document.getElementById("macInput"),i=t.selectionStart,a=t.selectionEnd,l=this.form.mac,n=this.form.mac,o=l.length;if(!l||l===this.oldMacAddr)return this.oldMacAddr=l,void(this.isChangeMac=!0);l=l.replace(/[:\-\s]/g,"");for(var s="",c=0;c<l.length/2;c++)void 0!=l[2*c+1]?s+=l[2*c]+l[2*c+1]+":":s+=l[2*c];l=s.trim().slice(0,17),this.form.mac=l;var r=setTimeout((function(){if(clearTimeout(r),l===e.oldMacAddr&&o===e.oldMacAddr.length-1)t.selectionStart=i,t.selectionEnd=i;else if(l.length<e.oldMacAddr.length){for(var s=0;s<l.length;s++)if(l[s]!==e.oldMacAddr[s])break;i!==o&&i!==a?(t.selectionStart=s+1,t.selectionEnd=s+1):(t.selectionStart=s,t.selectionEnd=s)}else if(i!==o){for(var c=0;c<e.oldMacAddr.length;c++)if(n[n.length-c-1]!=e.oldMacAddr[e.oldMacAddr.length-c-1])break;i%3==2&&l.length%3===2||i%3==0&&l.length%3===1?(t.selectionStart=l.length-c+1,t.selectionEnd=l.length-c+1):i%3==1&&l.length%3===0?(t.selectionStart=l.length-c-1,t.selectionEnd=l.length-c-1):(t.selectionStart=l.length-c,t.selectionEnd=l.length-c)}e.oldMacAddr=l,e.isChangeMac=!0}))}},leftBtn:function(e){this.$router.push({path:e})},rightBtn:function(){this.$refs.name.resetField(),this.$refs.mac.resetField(),this.visible=!1},changeVehicleType:function(e){var t=this;this.changeSelect=e,this.changeSelect?(this.modelId=[],this.form.modelId=""):Object(s["w"])(this.form.vehicleTypeId).then((function(e){t.getOptions(e,"modelName",t.modelId)}))},resetForm:function(e){this.$refs[e].resetFields()},getOptions:function(e,t,i){var a=e;a.forEach((function(e){var a={name:e[t],id:e.id};i.push(a)}))},addForm:function(){var e=this;this.$refs.form.validate((function(t){e.loading=!0,t?(e.form.macAddr=e.form.mac.replace(/:/g,"-"),Object(s["a"])(e.form).then((function(t){e.loading=!1})).catch((function(){e.loading=!1}))):e.loading=!1}))}}},m=d,f=(i("3663"),i("2877")),u=Object(f["a"])(m,a,l,!1,null,null,null);t["default"]=u.exports}}]);