(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9c1ff9d6"],{"3ef7":function(t,e,i){},"720d":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[t.deviceInfo?i("div",{staticClass:"details-container"},[i("div",{staticClass:"left"},[i("div",{staticClass:"left-top"},[i("div",{staticClass:"device-name"},[t._v("\n          "+t._s(t.deviceInfo.baseInfo.vehicleTypeName)+"\n          "+t._s(t.deviceInfo.details.modelName)+"\n        ")]),t._v(" "),i("div",{staticClass:"top-info-bar"},[i("div",{staticClass:"top-info-list"},[i("div",{staticClass:"top-info"},[i("div",{staticClass:"num"},[t._v("\n                "+t._s(t._f("dataDay")(t.deviceInfo.baseInfo.insertTime))+"\n              ")]),t._v(" "),i("div",{staticClass:"txt"},[t._v("入职时间")])])])]),t._v(" "),i("div",{staticClass:"device-img"},[i("img",{attrs:{src:t.imgUrl,alt:"暂无图片","οnerrοr":t.noImg}})]),t._v(" "),i("div",{staticClass:"detailed-parameters"},[i("table",[i("tbody",[t._m(0),t._v(" "),i("tr",[t._m(1),t._v(" "),i("td",{staticClass:"hover-edit-param"},[i("span",[t._v(t._s(t.deviceInfo.details.describetion))])])]),t._v(" "),i("tr",[t._m(2),t._v(" "),i("td",{staticClass:"hover-edit-param"},[i("span",[t._v(t._s(t.deviceInfo.baseInfo.id))])])]),t._v(" "),i("tr",[t._m(3),t._v(" "),i("td",{staticClass:"hover-edit-param"},[i("span",[t._v(t._s(t.deviceInfo.details.modelName))])])]),t._v(" "),i("tr",[t._m(4),t._v(" "),i("td",{staticClass:"hover-edit-param"},[i("span",[t._v(t._s(t.deviceInfo.baseInfo.vehicleTypeName))])])]),t._v(" "),i("tr",[t._m(5),t._v(" "),i("td",{staticClass:"hover-edit-param"},[i("span",[t._v(t._s(t.deviceInfo.details.measurements))])])]),t._v(" "),i("tr",[t._m(6),t._v(" "),i("td",{staticClass:"hover-edit-param"},[i("span",[t._v(t._s(t.deviceInfo.details.ratedLoad))])])]),t._v(" "),i("tr",[t._m(7),t._v(" "),i("td",{staticClass:"hover-edit-param"},[i("span",[t._v(t._s(t.deviceInfo.details.dockingType))])])])])])])]),t._v(" "),i("div",{staticClass:"bottom-menu"},[i("span",{staticClass:"common"},[t._v("常用功能")]),t._v(" "),i("el-divider",{attrs:{direction:"vertical"}}),t._v(" "),i("div",{staticClass:"btn-list"},[i("div",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"vehicle/list/add",expression:"'vehicle/list/add'"}],staticClass:"btn"},[i("router-link",{attrs:{to:{path:"/vehicle/add"}}},[i("div",{staticClass:"icon iconfont icon-tianjia1"}),t._v(" "),i("div",{staticClass:"txt"},[t._v("添加设备")])])],1),t._v(" "),i("div",{staticClass:"btn"},[i("router-link",{attrs:{to:{path:"/vehicle/vehiclelist"}}},[i("div",{staticClass:"icon iconfont icon-weibiaoti2010101"}),t._v(" "),i("div",{staticClass:"txt"},[t._v("设备列表")])])],1)])],1)]),t._v(" "),i("div",{staticClass:"right"},[i("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"工作概览",name:"first"}},[i("div",{staticClass:"now-status"},[i("div",{staticClass:"status-list"},[i("div",{staticClass:"list"},[i("div",{staticClass:"num"},[t._v("\n                  "+t._s(0!==t.deviceArr.length?"在线":"离线")+"\n                ")]),t._v(" "),i("p",[t._v("当前状态")])]),t._v(" "),i("div",{staticClass:"list"},[i("div",{staticClass:"num"},[t._v(t._s(t._f("fixed2")(t.deviceStatus.vx)))]),t._v(" "),i("p",[t._v("实时速度（m/s）")])]),t._v(" "),i("div",{staticClass:"list"},[i("div",{staticClass:"num"},[t._v(t._s(t._f("valueStatus")(t.deviceStatus.ele)))]),t._v(" "),i("p",[t._v("电量（%）")])]),t._v(" "),i("div",{staticClass:"list"},[i("div",{staticClass:"num"},[t._v(t._s(t._f("valueStatus")(t.deviceStatus.status)))]),t._v(" "),i("p",[t._v("状态")])])])]),t._v(" "),i("el-card",{staticClass:"task-status-list box-card2"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("任务次数")])]),t._v(" "),i("div",{staticClass:"task-list"},[i("div",{staticClass:"list"},[i("div",{staticClass:"num"},[t._v(t._s(t.taskNum.todayNum))]),t._v(" "),i("p",[t._v("今日新增")])]),t._v(" "),i("div",{staticClass:"list"},[i("div",{staticClass:"num"},[t._v(t._s(t.taskNum.yesterdayNum))]),t._v(" "),i("p",[t._v("昨日新增")])]),t._v(" "),i("div",{staticClass:"list"},[i("div",{staticClass:"num"},[t._v(t._s(t.taskNum.mouthNum))]),t._v(" "),i("p",[t._v("本月新增")])]),t._v(" "),i("div",{staticClass:"list"},[i("div",{staticClass:"num"},[t._v(t._s(t.taskNum.allNum))]),t._v(" "),i("p",[t._v("总数")])])])])],1),t._v(" "),i("el-tab-pane",{attrs:{label:"设备配置",name:"third"}},[i("div",{staticClass:"detailed-parameters"},[i("table",[i("tbody",[i("tr",[i("td",{staticClass:"hd",attrs:{colspan:"4"}},[t._v("基本参数")])]),t._v(" "),i("tr",[i("th",[i("span",[t._v("设备型号")])]),t._v(" "),i("td",{staticClass:"hover-edit-param",attrs:{colspan:"4"}},[i("span",[t._v(t._s(t.deviceInfo.details.modelName))])])]),t._v(" "),i("tr",[i("th",[i("span",[t._v("设备名称")])]),t._v(" "),i("td",{staticClass:"hover-edit-param",attrs:{colspan:"4"}},[i("span",[t._v(t._s(t.deviceInfo.baseInfo.name))]),t._v(" "),i("i",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"vehicle/list/update",expression:"'vehicle/list/update'"}],staticClass:"icon iconfont icon-xiugai-copy",on:{click:function(e){return t.changeInfo("name")}}},[t._v("修改")])])]),t._v(" "),i("tr",[i("th",[i("span",[t._v("软件版本号")])]),t._v(" "),i("td",{staticClass:"hover-edit-param",attrs:{colspan:"4"}},[i("span",[t._v(t._s(t.deviceInfo.baseInfo.softwareVer))])])]),t._v(" "),i("tr",[i("th",[i("span",[t._v("硬件版本号")])]),t._v(" "),i("td",{staticClass:"hover-edit-param",attrs:{colspan:"4"}},[i("span",[t._v(t._s(t.deviceInfo.baseInfo.hardwareVer))])])]),t._v(" "),i("tr",[i("th",[i("span",[t._v("Mac地址")])]),t._v(" "),i("td",{staticClass:"hover-edit-param",attrs:{colspan:"4"}},[i("span",[t._v(t._s(t.deviceInfo.baseInfo.macAddr))])])]),t._v(" "),i("tr",[i("th",[i("span",[t._v("所在区域")])]),t._v(" "),i("td",{staticClass:"hover-edit-param",attrs:{colspan:"4"}},[i("span",[t._v(t._s(t.deviceInfo.baseInfo.domainName))]),t._v(" "),i("i",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"vehicle/list/update",expression:"'vehicle/list/update'"}],staticClass:"icon iconfont icon-xiugai-copy",on:{click:function(e){return t.changeInfo("domain")}}},[t._v("修改")])])]),t._v(" "),i("tr",[i("th",[i("span",[t._v("设备状态")])]),t._v(" "),i("td",{staticClass:"hover-edit-param",attrs:{colspan:"4"}},[i("span",[t._v(t._s(t._f("enabledState")(t.deviceInfo.baseInfo.enabledState)))]),t._v(" "),i("i",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"vehicle/list/update",expression:"'vehicle/list/update'"}],staticClass:"icon iconfont icon-xiugai-copy",on:{click:function(e){return t.changeInfo("device")}}},[t._v("修改")])])]),t._v(" "),i("tr",[i("td",{staticClass:"hd",attrs:{colspan:"4"}},[t._v("网络参数")])]),t._v(" "),i("tr",[i("th",[i("span",[t._v("接入协议")])]),t._v(" "),i("td",{staticClass:"hover-edit-param",attrs:{colspan:"4"}},[i("span",[t._v(t._s(t.deviceInfo.baseInfo.protocol))])])]),t._v(" "),i("tr",[i("th",[i("span",[t._v("IP")])]),t._v(" "),i("td",{staticClass:"hover-edit-param"},[i("span",[t._v(t._s(t.deviceInfo.ip))])])]),t._v(" "),i("tr",[i("td",{staticClass:"hd",attrs:{colspan:"4"}},[t._v("设备分组")])]),t._v(" "),i("tr",[i("th",[i("span",[t._v("组名称")])]),t._v(" "),i("td",{staticClass:"hover-edit-param"},[i("span",[t._v(t._s(t.deviceGroupName))]),t._v(" "),i("i",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"vehicle/list/update",expression:"'vehicle/list/update'"}],staticClass:"icon iconfont icon-xiugai-copy",on:{click:function(e){return t.changeInfo("group")}}},[t._v("修改")]),t._v(" "),"未绑定"!==t.deviceGroupName?i("i",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"vehicle/list/update",expression:"'vehicle/list/update'"}],staticClass:"icon iconfont icon-xiugai-copy unbind",on:{click:t.unBind}},[t._v("解绑")]):t._e()])]),t._v(" "),i("tr",[i("td",{staticClass:"hd",attrs:{colspan:"4"}},[t._v("休息点")])]),t._v(" "),i("tr",[i("th",[i("span",[t._v("绑定地图")])]),t._v(" "),i("td",{staticClass:"hover-edit-param"},[t.bindPoints.find((function(t){return 3===t.spotType}))?i("span",[t._v(t._s(t._f("domainMap")(t.bindPoints.find((function(t){return 3===t.spotType})).mapId)))]):i("span",[t._v("未绑定")])]),t._v(" "),i("th",{staticClass:"last-th"},[i("span",[t._v("绑定点")])]),t._v(" "),i("td",{staticClass:"hover-edit-param"},[t.bindPoints.find((function(t){return 3===t.spotType}))?i("span",[t._v(t._s(t._f("mapPoints")(t.bindPoints.find((function(t){return 3===t.spotType})).spotId)))]):i("span",[t._v("未绑定")]),t._v(" "),i("i",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"vehicle/list/update",expression:"'vehicle/list/update'"}],staticClass:"icon iconfont icon-xiugai-copy",on:{click:function(e){return t.changeInfo("rest")}}},[t._v("修改")]),t._v(" "),0!==t.restId?i("i",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"vehicle/list/update",expression:"'vehicle/list/update'"}],staticClass:"icon iconfont icon-xiugai-copy unbind",on:{click:function(e){return t.unBindPoints(t.restId)}}},[t._v("解绑")]):t._e()])]),t._v(" "),i("tr",[i("td",{staticClass:"hd",attrs:{colspan:"4"}},[t._v("充电桩")])]),t._v(" "),i("tr",[i("th",[i("span",[t._v("绑定地图")])]),t._v(" "),i("td",{staticClass:"hover-edit-param"},[t.chargeInfo.mapId?i("span",[t._v(t._s(t._f("domainMap")(t.chargeInfo.mapId)))]):i("span",[t._v("未绑定")])]),t._v(" "),i("th",{staticClass:"last-th"},[i("span",[t._v("绑定充电桩")])]),t._v(" "),i("td",{staticClass:"hover-edit-param"},[i("span",[t._v(t._s(t.chargeInfo.name||"未绑定"))]),t._v(" "),-1!==t.chargeInfo.id?i("i",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"vehicle/list/update",expression:"'vehicle/list/update'"}],staticClass:"icon iconfont icon-xiugai-copy",on:{click:t.unBindCharge}},[t._v("解绑")]):t._e(),t._v(" "),-1!==t.chargeInfo.id?i("i",{staticClass:"icon iconfont icon-xiugai-copy unbind",on:{click:t.goToStationPage}},[t._v("详情")]):i("i",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"vehicle/list/update",expression:"'vehicle/list/update'"}],staticClass:"icon iconfont icon-xiugai-copy",on:{click:function(e){return t.changeInfo("charge")}}},[t._v("绑定")])])])])])])]),t._v(" "),i("el-tab-pane",{attrs:{label:"点位资源",name:"second"}},[i("el-card",{staticClass:"box-card2"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("已占用点位")])]),t._v(" "),i("div",{staticClass:"point-list"},[t._l(t.points,(function(e,a){return 0!==t.points.length?i("span",{key:a,staticClass:"point"},[i("el-tag",[t._v(t._s(e.code))])],1):t._e()})),t._v(" "),0===t.points.length?i("span",{staticClass:"null-data"},[t._v("无占用点位")]):t._e()],2),t._v(" "),i("el-button",{staticClass:"out-points",attrs:{type:"primary"},on:{click:t.getPoints}},[t._v("手动刷新")]),t._v(" "),i("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"vehicle/list/update",expression:"'vehicle/list/update'"}],staticClass:"out-points",on:{click:t.outPoints}},[t._v("释放点位")])],1)],1)],1)],1)]):t._e(),t._v(" "),i("el-dialog",{attrs:{title:"修改设备配置",visible:t.dialogVisible,width:"20%",center:""},on:{close:t.closeDialog,"update:visible":function(e){t.dialogVisible=e}}},[i("el-form",{ref:"form",staticClass:"auth-form",attrs:{"label-width":"100px",model:t.form,rules:t.formRules}},["domain"===t.propType?i("el-form-item",{staticClass:"user-info-input",attrs:{label:"工作域：",prop:"info"}},[i("el-select",{model:{value:t.form.info,callback:function(e){t.$set(t.form,"info",e)},expression:"form.info"}},t._l(t.domainTypeList,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1):"name"===t.propType?i("el-form-item",{staticClass:"user-info-input",attrs:{label:t.labelName,prop:"info"}},[i("el-input",{staticClass:"auth-input",attrs:{maxlength:"30"},model:{value:t.form.info,callback:function(e){t.$set(t.form,"info","string"===typeof e?e.trim():e)},expression:"form.info"}})],1):"group"===t.propType?i("el-form-item",{staticClass:"user-info-input",attrs:{label:t.labelName,prop:"info"}},[i("el-select",{on:{change:t.groupChange},model:{value:t.form.info,callback:function(e){t.$set(t.form,"info",e)},expression:"form.info"}},t._l(t.deviceGroup,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),t._v(" "),i("div",{staticClass:"tag-list"},t._l(t.filterOrderName,(function(e,a){return i("el-tag",{key:a,staticClass:"tag"},[t._v(t._s(e.orderChainTemplateName))])})),1)],1):"rest"===t.propType?i("el-form-item",{staticClass:"user-info-input",attrs:{label:t.labelName,prop:"info"}},[i("el-cascader",{staticClass:"self-placeholder",attrs:{options:t.restList,filterable:"","show-all-levels":!1,clearable:"",size:"small",props:t.areaProp},model:{value:t.form.info,callback:function(e){t.$set(t.form,"info",e)},expression:"form.info"}})],1):"charge"===t.propType?i("el-form-item",{staticClass:"user-info-input",attrs:{label:t.labelName,prop:"info"}},[i("el-cascader",{staticClass:"self-placeholder",attrs:{options:t.chargeList,filterable:"","show-all-levels":!1,clearable:"",size:"small",props:t.stationProp},model:{value:t.form.info,callback:function(e){t.$set(t.form,"info",e)},expression:"form.info"}})],1):i("el-form-item",{staticClass:"user-info-input",attrs:{label:t.labelName,prop:"info"}},[i("el-select",{model:{value:t.form.info,callback:function(e){t.$set(t.form,"info",e)},expression:"form.info"}},t._l(t.deviceStatusList,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.cancelBtn}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.sendBtn}},[t._v("确 定")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"提示",visible:t.delVisible,width:"300px",center:""},on:{"update:visible":function(e){t.delVisible=e}}},[i("div",{staticClass:"del-dialog-cnt"},[t._v("确定释放点位？")]),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.delVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.deletePoint}},[t._v("确 定")])],1)])],1)},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",[i("td",{staticClass:"hd",attrs:{colspan:"4"}},[t._v("配置参数")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("th",[i("span",[t._v("简介")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("th",[i("span",[t._v("设备ID")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("th",[i("span",[t._v("型号")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("th",[i("span",[t._v("设备类型")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("th",[i("span",[t._v("尺寸")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("th",[i("span",[t._v("额定负载")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("th",[i("span",[t._v("对接类型")])])}],n=(i("7f7f"),i("7514"),i("ac6a"),i("db72")),o=i("aa98"),c=i("b199"),l=i("9659"),r=i("7661"),d=i("4360"),v=i("2f62"),f=i("2ef0"),p=i.n(f),u={computed:Object(n["a"])({},Object(v["b"])(["deviceGroupList","domainTypeList","domainMapList"])),data:function(){var t=this,e=function(e,i,a){Object(l["a"])(i,a,t.propType)};return{activeName:"first",delVisible:!1,sokitTimerDevice:"",sokitTimerDevice2:"",noImg:"http://"+window.location.host+"/static/device/no-img.png",points:[],mapId:"",imgUrl:"",timer:null,yesterday:"",deviceImg:"",monthNum:"",allNum:"",dialogVisible:!1,deviceInfo:"",taskNum:{},deviceId:"",deviceStatus:{},deviceArr:[],restList:[],chargeList:[],stationProp:[],disable:!1,vx:"",ele:"",status:"",labelName:"",propType:"",workSpaceList:"",restId:0,chargeInfo:{id:-1},setTimerDevice:null,loading:!1,deviceStatusList:[{id:0,name:"启用"},{id:1,name:"维护"},{id:2,name:"停用"}],tip:"",deviceGroup:[],filterOrderName:[],bindPoints:[],endPointCodeList:[],deviceGroupName:"未分组",form:{info:""},groupDevice:[],formRules:{info:[{required:!0,trigger:"blur",validator:e}]}}},watch:{deviceArr:{handler:function(t,e){var i=[];return i=t,i}},points:{handler:function(t,e){var i=[];return i=t,i}}},beforeDestroy:function(){clearInterval(this.sokitTimerDevice),clearInterval(this.setTimerDevice),this.timer&&this.timer.close()},created:function(){var t=this;this.deviceId=this.$route.params.vehicleId,this.getDetail(this.deviceId),Object(c["u"])(this.deviceId).then((function(e){t.taskNum=e})),Object(c["w"])().then((function(e){t.groupDevice=e})),this.getBindPoints(),this.getBindStation(),this.websocket(),this.getTrafficPoint(this.deviceId),this.setTimerDevice=setInterval((function(){t.getTrafficPoint(t.deviceId)}),3e3),this.deviceGroup=this.deviceGroupList,this.getDevice(),this.stationProp={lazy:!0,lazyLoad:function(t,e){setTimeout((function(){console.log("station");var i=[];1===t.level&&Object(o["o"])({mapIds:[t.value]}).then((function(a){a&&a.data&&(i=a.data.map((function(e){return{value:e.id,label:"".concat(e.code,"(").concat(e.typeName,")"),leaf:1===t.level}}))),e(i)})),e(i)}),100)}}},methods:{getBindPoints:function(){var t=this;this.restId=0,Object(o["r"])(this.deviceId).then((function(e){e.forEach((function(e){3===e.spotType&&(t.restId=e.id)})),t.bindPoints=e}))},getBindStation:function(){var t=this;Object(o["s"])(this.deviceId).then((function(e){t.chargeInfo=e?{id:e.id,name:e.code,mapId:e.mapId}:{id:-1}}))},groupChange:function(t){var e=this.groupDevice.find((function(e){return e.groupId===t}));e&&(this.filterOrderName=e.nameList)},unBindPoints:function(t){var e=this;this.$confirm("确定解绑休息点?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["d"])(t).then((function(){e.getBindPoints(),e.loading=!1,e.dialogVisible=!1}))}))},unBindCharge:function(){var t=this;this.$confirm("确定解绑充电桩?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["e"])(t.deviceId).then((function(){t.chargeInfo={id:-1},t.loading=!1,t.dialogVisible=!1}))}))},unBind:function(){var t=this;this.$confirm("确定解绑组?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["M"])(t.deviceId,null).then((function(){t.getDevice(),t.loading=!1,t.dialogVisible=!1}))}))},unBindPoint:function(){var t=this;this.$confirm("确定解绑?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["d"])(t.deviceId,null).then((function(){t.getDevice(),t.loading=!1,t.dialogVisible=!1}))}))},getTrafficPoint:function(t){var e=this;Object(r["g"])(t).then((function(t){e.points=t}))},getDevice:function(){var t=this;Object(o["q"])(this.deviceId).then((function(e){t.deviceGroupName=e.groupId?t.deviceGroup.find((function(t){return t.id==e.groupId})).name:"未绑定"}))},getPoints:function(){this.getTrafficPoint(this.deviceId)},deletePoint:function(){var t=this;Object(o["F"])(this.deviceId).then((function(e){e.status&&(t.points=[]),t.delVisible=!1}))},outPoints:function(){if(0===this.points.length)return this.$message.warning("无占用点位无法执行此操作"),!1;this.delVisible=!0},websocketsend:function(t){this.timer.send(JSON.stringify(t))},websocket:function(){var t=this,e=window.g.wsURL+"/ws/vehicle";this.timer=new WebSocket(e),this.timer.onmessage=function(e){JSON.parse(e.data).status&&(t.websocketsend({vehicleId:t.deviceId}),t.sokitTimerDevice=setInterval((function(){t.websocketsend({vehicleId:t.deviceId})}),3e3));var i=JSON.parse(e.data);0!==i.length&&i.constructor===Array&&void 0!==i[0].ele&&(t.deviceStatus=i[0],t.deviceArr=i)}},getDetail:function(t){var e=this;Object(o["u"])(t).then((function(t){var i=e;e.deviceInfo=t,e.deviceImg=e.deviceInfo.details.modelName,e.imgUrl="http://"+window.location.host+"/static/device/"+e.deviceImg+".png";var a=t.baseInfo.domainId;Object(r["f"])(a).then((function(t){t.forEach((function(t){t.label=t.alias?t.alias:t.code})),e.endPointCodeList=t,d["a"].dispatch("GET_MAP_POINTS",t).then((function(){e.areaProp={lazy:!0,lazyLoad:function(t,e){setTimeout((function(){console.log("point");var a=[];1===t.level&&(i.endPointCodeList.forEach((function(e,i){t.data.type===e.type&&e.mapId===t.value&&a.push({label:e.label,value:e.id,type:e.type,leaf:1===t.level})})),e(a))}),100)}}}))}));var s=e.domainMapList.find((function(t){return t.value===a}));if(s){var n=p.a.cloneDeep(s.children);n.forEach((function(t){t.type=3})),e.restList=n,e.chargeList=JSON.parse(JSON.stringify(n))}}))},handleClick:function(t,e){},closeDialog:function(){this.$refs.form.clearValidate(),this.filterOrderName=[]},cancelBtn:function(){this.dialogVisible=!1,this.$refs.form.resetFields()},changeInfo:function(t){switch(this.form.info="",this.dialogVisible=!0,t){case"device":this.labelName="设备状态",this.propType="device";break;case"name":this.labelName="设备名称",this.propType="name";break;case"domain":this.labelName="所在区域",this.propType="domain";break;case"group":this.labelName="设备分组",this.propType="group";break;case"rest":this.labelName="休息点",this.propType="rest";break;case"charge":this.labelName="充电桩",this.propType="charge";break}},refreshList:function(){this.loading=!1,this.dialogVisible=!1,this.getDetail(this.deviceId),this.getBindPoints(),this.getDevice()},sendBtn:function(){var t=this;this.$refs.form.validate((function(e){if(e){t.loading=!0;var i={id:t.deviceId};if("name"===t.propType)i.name=t.form.info,Object(o["O"])(i).then((function(){t.refreshList(),t.loading=!1})).catch((function(){t.loading=!1}));else if("domain"===t.propType)i.domainId=t.form.info,Object(o["J"])(i).then((function(){t.refreshList(),t.getBindStation(),t.loading=!1})).catch((function(){t.loading=!1}));else if("group"===t.propType)Object(o["M"])(t.deviceId,t.form.info).then((function(){t.getDevice(),t.loading=!1,t.dialogVisible=!1})).catch((function(){t.loading=!1}));else if("rest"===t.propType){var a={vehicleId:t.deviceId,spotId:t.form.info[1],mapId:t.form.info[0],spotType:3};Object(o["G"])(a).then((function(){t.getBindPoints(),t.loading=!1,t.dialogVisible=!1})).catch((function(){t.loading=!1}))}else if("charge"===t.propType){if(console.log(t.form.info),t.form.info.length>1){var s={vehicleId:t.deviceId,stationId:t.form.info[1]};Object(o["H"])(s).then((function(e){t.getBindStation(),t.loading=!1,t.dialogVisible=!1})).catch((function(){t.loading=!1}))}t.loading=!1}else i.state=t.form.info,Object(o["P"])(i).then((function(){t.refreshList(),t.loading=!1})).catch((function(){t.loading=!1}))}else t.loading=!1}))},goToStationPage:function(){this.$router.push({name:"vehiclespares",query:{vehicleId:this.chargeInfo.id}})}}},h=u,m=(i("b390"),i("2877")),_=Object(m["a"])(h,a,s,!1,null,null,null);e["default"]=_.exports},b390:function(t,e,i){"use strict";var a=i("3ef7"),s=i.n(a);s.a}}]);