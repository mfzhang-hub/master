{"version":3,"sources":["webpack:///./src/api/config/domain.js","webpack:///./src/views/map/detail.vue?89f1","webpack:///src/views/map/detail.vue","webpack:///./src/views/map/detail.vue?5f68","webpack:///./src/views/map/detail.vue","webpack:///./src/api/map.js","webpack:///./src/views/map/detail.vue?bfcb"],"names":["getDomainList","data","request","post","editDomain","deleteDomain","id","render","_vm","this","_h","$createElement","_c","_self","directives","name","rawName","value","expression","staticClass","staticStyle","attrs","step","slot","backPage","topologyMap","alias","on","goBack","_v","_s","model","callback","$$v","spotFilter","trim","spots","innerHeight","background","scopedSlots","_u","key","fn","scope","row","vertexPo","code","style","height","$event","toggleEnable","$set","marginRight","mapFileUrl","nodeEnv","replace","openEditDialog","deleteMap","fileSize","Math","floor","_f","updateTime","area","ref","pngSrc","isDialog","closeDialog","mapForm","mapRules","_l","Number","_n","$router","push","path","query","mapId","fileName","areaName","domainList","areaId","$route","fullPath","saveEdit","staticRenderFns","props","loading","Edge","Vertex","determineTurningAngle","computed","filter","str","mounted","getMapDetailById","onResize","res","state","forEach","methods","$nextTick","document","getElementById","maxWidth","maxHeight","$confirm","JSON","parse","stringify","$refs","clearValidate","validate","valid","enable","component","getMapList","get","updateMap","getMapDetails"],"mappings":"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","file":"js/chunk-af6ba9aa.1628755099899.js","sourcesContent":["import request from '@/utils/request'\n\n// 获取所有工作区域列表☑️\nexport function getDomainList(data) {\n  return request.post('/area/list', data)\n}\n\n// 新增和修改工作区域☑️\nexport function editDomain(data) {\n  return request.post(\"/area/update\", data)\n}\n\n// 删除工作区域☑️\nexport function deleteDomain(id) {\n  return request.post(\"/area/delete/\" + id)\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"mapDetails-container\"},[_c('div',{staticClass:\"content-box step-main\"},[_c('el-steps',{staticStyle:{\"transform\":\"scale(1.3)\"},attrs:{\"active\":_vm.step,\"align-center\":\"\"}},[_c('el-step',{attrs:{\"title\":\"上传地图\"}},[_c('v-icon',{attrs:{\"slot\":\"icon\",\"name\":\"arrow-alt-circle-up\"},slot:\"icon\"})],1),_c('el-step',{attrs:{\"title\":\"地图启用\"}},[_c('v-icon',{attrs:{\"slot\":\"icon\",\"name\":\"play-circle\"},slot:\"icon\"})],1),_c('el-step',{attrs:{\"title\":\"完成\"}},[_c('v-icon',{attrs:{\"slot\":\"icon\",\"name\":\"check-circle\"},slot:\"icon\"})],1)],1),_c('div',{staticClass:\"step-title\"},[(!_vm.backPage)?_c('span',[_vm._v(_vm._s(_vm.topologyMap.alias || _vm.topologyMap.name))]):_c('el-page-header',{attrs:{\"content\":_vm.topologyMap.alias || _vm.topologyMap.name},on:{\"back\":_vm.goBack}})],1)],1),_c('div',{staticClass:\"spot-map-main\"},[_c('div',{staticClass:\"content-box spot-main\"},[_c('div',{staticClass:\"spot-filter\"},[_c('el-input',{attrs:{\"placeholder\":\"ID/编号/别名\",\"clearable\":\"\",\"maxlength\":30},model:{value:(_vm.spotFilter),callback:function ($$v) {_vm.spotFilter=(typeof $$v === 'string'? $$v.trim(): $$v)},expression:\"spotFilter\"}},[_c('span',{attrs:{\"slot\":\"prepend\"},slot:\"prepend\"},[_vm._v(\"工位点\")])])],1),_c('el-table',{attrs:{\"data\":_vm.spots,\"height\":_vm.innerHeight - 288,\"header-cell-style\":{ background: '#eee' },\"highlight-current-row\":\"\",\"stripe\":\"\"}},[_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"ID\",\"fixed\":\"left\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(scope.row.vertexPo.id)+\" \")]}}])}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"编号\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(scope.row.vertexPo.code)+\" \")]}}])}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"别名\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(scope.row.vertexPo.alias || \"---\")+\" \")]}}])})],1)],1),_c('div',{staticClass:\"content-box map-main\",style:({ height: _vm.innerHeight - 228 + 'px' })},[_c('div',{staticClass:\"header\"},[_c('span',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.topologyMap.alias || _vm.topologyMap.name))]),_c('span',{staticClass:\"buttons\"},[_c('el-switch',{directives:[{name:\"hasPermi\",rawName:\"v-hasPermi\",value:('map/update'),expression:\"'map/update'\"}],staticClass:\"switch\",attrs:{\"active-value\":1,\"inactive-value\":0},on:{\"change\":function($event){return _vm.toggleEnable()}},model:{value:(_vm.topologyMap.enable),callback:function ($$v) {_vm.$set(_vm.topologyMap, \"enable\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"topologyMap.enable\"}}),_c('a',{directives:[{name:\"hasPermi\",rawName:\"v-hasPermi\",value:('map/download'),expression:\"'map/download'\"}],style:({ marginRight: '10px' }),attrs:{\"href\":_vm.topologyMap.mapFileUrl &&\n              (_vm.nodeEnv === 'development' ? '/api/' : '/') +\n                _vm.topologyMap.mapFileUrl.replace(/\\\\/g, '/')}},[_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"primary\",\"plain\":\"\"}},[_vm._v(\"下载\")])],1),_c('el-button',{directives:[{name:\"hasPermi\",rawName:\"v-hasPermi\",value:('map/update'),expression:\"'map/update'\"}],attrs:{\"size\":\"mini\",\"type\":\"warning\",\"plain\":\"\"},on:{\"click\":function($event){return _vm.openEditDialog()}}},[_vm._v(\"修改\")]),_c('el-button',{directives:[{name:\"hasPermi\",rawName:\"v-hasPermi\",value:('map/delete'),expression:\"'map/delete'\"}],attrs:{\"size\":\"mini\",\"type\":\"danger\",\"plain\":\"\"},on:{\"click\":function($event){return _vm.deleteMap()}}},[_vm._v(\"删除\")])],1)]),_c('div',{staticClass:\"detail\"},[_c('div',[_vm._v(\"地图ID: \"+_vm._s(_vm.topologyMap.id))]),_c('div',[_vm._v(\" 大小: \"+_vm._s(_vm.topologyMap.fileSize && Math.floor(_vm.topologyMap.fileSize * 1000) + \"KB\")+\" \")]),_c('div',[_vm._v(\"更新时间: \"+_vm._s(_vm._f(\"dateTime\")(_vm.topologyMap.updateTime)))]),_c('div',[_vm._v(\"区域名称: \"+_vm._s(_vm.area.name))])]),_c('div',{ref:\"imageParent\",staticClass:\"image\"},[_c('img',{attrs:{\"src\":_vm.pngSrc,\"id\":\"imageChild\"}})])])]),_c('el-dialog',{attrs:{\"title\":\"编辑地图\",\"visible\":_vm.isDialog,\"width\":\"410px\",\"center\":\"\"},on:{\"update:visible\":function($event){_vm.isDialog=$event},\"close\":_vm.closeDialog}},[_c('el-form',{ref:\"mapForm\",attrs:{\"label-width\":\"85px\",\"model\":_vm.mapForm,\"rules\":_vm.mapRules}},[_c('el-form-item',{attrs:{\"label\":\"地图别名: \"}},[_c('el-input',{attrs:{\"clearable\":\"\",\"placeholder\":\"请输入地图别名\",\"maxlength\":30},model:{value:(_vm.mapForm.alias),callback:function ($$v) {_vm.$set(_vm.mapForm, \"alias\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"mapForm.alias\"}})],1),_c('el-form-item',{attrs:{\"label\":\"工作区域: \",\"prop\":\"areaId\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择区域\",\"clearable\":\"\",\"filterable\":\"\"},model:{value:(_vm.mapForm.areaId),callback:function ($$v) {_vm.$set(_vm.mapForm, \"areaId\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"mapForm.areaId\"}},_vm._l((_vm.domainList),function(value,key){return _c('el-option',{key:key,attrs:{\"label\":value,\"value\":Number(key)}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"楼层: \",\"prop\":\"floor\"}},[_c('el-input-number',{attrs:{\"precision\":0,\"step\":1,\"controls-position\":\"right\"},model:{value:(_vm.mapForm.floor),callback:function ($$v) {_vm.$set(_vm.mapForm, \"floor\", _vm._n($$v))},expression:\"mapForm.floor\"}})],1),_c('el-form-item',{attrs:{\"label\":\"转弯角度: \",\"prop\":\"determineTurningAngle\"}},[_c('el-input-number',{attrs:{\"precision\":2,\"step\":1,\"controls-position\":\"right\"},model:{value:(_vm.mapForm.determineTurningAngle),callback:function ($$v) {_vm.$set(_vm.mapForm, \"determineTurningAngle\", _vm._n($$v))},expression:\"mapForm.determineTurningAngle\"}})],1),_c('el-form-item',{attrs:{\"label\":\"地图包: \"}},[_c('el-button',{attrs:{\"type\":\"success\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.$router.push({\n              path: '/mapEditor',\n              query: {\n                mapId: _vm.mapForm.id,\n                fileName: _vm.mapForm.name,\n                areaName: _vm.domainList[_vm.mapForm.areaId],\n                backPage: _vm.$route.fullPath,\n              },\n            })}}},[_vm._v(\"编辑\")])],1)],1),_c('span',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":_vm.closeDialog}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.saveEdit}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"mapDetails-container\" v-loading=\"loading\">\n    <div class=\"content-box step-main\">\n      <el-steps :active=\"step\" align-center style=\"transform: scale(1.3)\">\n        <el-step title=\"上传地图\"\n          ><v-icon slot=\"icon\" name=\"arrow-alt-circle-up\"\n        /></el-step>\n        <el-step title=\"地图启用\"\n          ><v-icon slot=\"icon\" name=\"play-circle\"\n        /></el-step>\n        <el-step title=\"完成\"\n          ><v-icon slot=\"icon\" name=\"check-circle\"\n        /></el-step>\n      </el-steps>\n      <div class=\"step-title\">\n        <span v-if=\"!backPage\">{{\n          topologyMap.alias || topologyMap.name\n        }}</span>\n        <el-page-header\n          @back=\"goBack\"\n          :content=\"topologyMap.alias || topologyMap.name\"\n          v-else\n        >\n        </el-page-header>\n      </div>\n    </div>\n    <div class=\"spot-map-main\">\n      <div class=\"content-box spot-main\">\n        <div class=\"spot-filter\">\n          <el-input\n            placeholder=\"ID/编号/别名\"\n            v-model.trim=\"spotFilter\"\n            clearable\n            :maxlength=\"30\"\n          >\n            <span slot=\"prepend\">工位点</span>\n          </el-input>\n        </div>\n        <el-table\n          :data=\"spots\"\n          :height=\"innerHeight - 288\"\n          :header-cell-style=\"{ background: '#eee' }\"\n          highlight-current-row\n          stripe\n        >\n          <el-table-column align=\"center\" label=\"ID\" fixed=\"left\">\n            <template slot-scope=\"scope\">\n              {{ scope.row.vertexPo.id }}\n            </template></el-table-column\n          >\n          <el-table-column align=\"center\" label=\"编号\">\n            <template slot-scope=\"scope\">\n              {{ scope.row.vertexPo.code }}\n            </template></el-table-column\n          >\n          <el-table-column align=\"center\" label=\"别名\">\n            <template slot-scope=\"scope\">\n              {{ scope.row.vertexPo.alias || \"---\" }}\n            </template>\n          </el-table-column>\n        </el-table>\n      </div>\n      <div\n        class=\"content-box map-main\"\n        :style=\"{ height: innerHeight - 228 + 'px' }\"\n      >\n        <div class=\"header\">\n          <span class=\"title\">{{ topologyMap.alias || topologyMap.name }}</span>\n          <span class=\"buttons\">\n            <el-switch\n              v-model.trim=\"topologyMap.enable\"\n              :active-value=\"1\"\n              :inactive-value=\"0\"\n              @change=\"toggleEnable()\"\n              class=\"switch\"\n              v-hasPermi=\"'map/update'\"\n            ></el-switch>\n            <a\n              :href=\"\n                topologyMap.mapFileUrl &&\n                (nodeEnv === 'development' ? '/api/' : '/') +\n                  topologyMap.mapFileUrl.replace(/\\\\/g, '/')\n              \"\n              :style=\"{ marginRight: '10px' }\"\n              v-hasPermi=\"'map/download'\"\n            >\n              <el-button size=\"mini\" type=\"primary\" plain>下载</el-button>\n            </a>\n            <el-button\n              @click=\"openEditDialog()\"\n              size=\"mini\"\n              type=\"warning\"\n              plain\n              v-hasPermi=\"'map/update'\"\n              >修改</el-button\n            >\n            <el-button\n              @click=\"deleteMap()\"\n              size=\"mini\"\n              type=\"danger\"\n              plain\n              v-hasPermi=\"'map/delete'\"\n              >删除</el-button\n            >\n          </span>\n        </div>\n        <div class=\"detail\">\n          <div>地图ID: {{ topologyMap.id }}</div>\n          <div>\n            大小:\n            {{\n              topologyMap.fileSize &&\n              Math.floor(topologyMap.fileSize * 1000) + \"KB\"\n            }}\n          </div>\n          <!-- <div>版本: {{ topologyMap.versin || \"---\" }}</div> -->\n          <div>更新时间: {{ topologyMap.updateTime | dateTime }}</div>\n          <div>区域名称: {{ area.name }}</div>\n          <!-- <div>操作人员: {{ topologyMap.userInfo || \"---\" }}</div> -->\n        </div>\n        <div class=\"image\" ref=\"imageParent\">\n          <img :src=\"pngSrc\" id=\"imageChild\" />\n        </div>\n      </div>\n    </div>\n    <el-dialog\n      title=\"编辑地图\"\n      :visible.sync=\"isDialog\"\n      width=\"410px\"\n      center\n      @close=\"closeDialog\"\n    >\n      <el-form\n        label-width=\"85px\"\n        :model=\"mapForm\"\n        :rules=\"mapRules\"\n        ref=\"mapForm\"\n      >\n        <el-form-item label=\"地图别名: \">\n          <el-input\n            v-model.trim=\"mapForm.alias\"\n            clearable\n            placeholder=\"请输入地图别名\"\n            :maxlength=\"30\"\n          />\n        </el-form-item>\n        <el-form-item label=\"工作区域: \" prop=\"areaId\">\n          <el-select\n            v-model.trim=\"mapForm.areaId\"\n            placeholder=\"请选择区域\"\n            clearable\n            filterable\n          >\n            <el-option\n              v-for=\"(value, key) in domainList\"\n              :key=\"key\"\n              :label=\"value\"\n              :value=\"Number(key)\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"楼层: \" prop=\"floor\">\n          <el-input-number\n            v-model.number=\"mapForm.floor\"\n            :precision=\"0\"\n            :step=\"1\"\n            controls-position=\"right\"\n          ></el-input-number>\n        </el-form-item>\n        <el-form-item label=\"转弯角度: \" prop=\"determineTurningAngle\">\n          <el-input-number\n            v-model.number=\"mapForm.determineTurningAngle\"\n            :precision=\"2\"\n            :step=\"1\"\n            controls-position=\"right\"\n          ></el-input-number>\n        </el-form-item>\n        <el-form-item label=\"地图包: \">\n          <el-button\n            type=\"success\"\n            size=\"mini\"\n            @click=\"\n              $router.push({\n                path: '/mapEditor',\n                query: {\n                  mapId: mapForm.id,\n                  fileName: mapForm.name,\n                  areaName: domainList[mapForm.areaId],\n                  backPage: $route.fullPath,\n                },\n              })\n            \"\n            >编辑</el-button\n          >\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\">\n        <el-button @click=\"closeDialog\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"saveEdit\">确 定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport { updateMap, getMapDetails, deleteMap } from \"@/api/map\";\nimport { getDomainList } from \"@/api/config/domain\";\nimport { Message, MessageBox } from \"element-ui\";\nexport default {\n  name: \"mapDetails\",\n  props: [\"innerHeight\"],\n  data() {\n    return {\n      loading: true, //等待\n      spotFilter: \"\", //点位过滤\n      Edge: [], //路径\n      Vertex: [], //点位\n      area: {}, //区域\n      topologyMap: {}, //地图详情\n      step: 1, //地图当前进度\n      pngSrc: \"\", //png地址\n      mapForm: { alias: \"\", reaId: \"\", floor: \"\", determineTurningAngle: \"\" },\n      isDialog: false, //是否打开修改地图弹框\n      mapRules: {\n        areaName: [\n          { required: true, trigger: \"change\", message: \"请选择工作区域\" },\n        ],\n        areaId: [\n          { required: true, trigger: \"change\", message: \"请选择工作区域\" },\n        ],\n        floor: [\n          {\n            message: \"楼层应为数字\",\n            pattern: /^[-.\\d]+$/,\n            trigger: \"blur\",\n          },\n        ],\n        determineTurningAngle: [\n          {\n            message: \"转弯角度应为数字\",\n            pattern: /^[-.\\d]+$/,\n            trigger: \"blur\",\n          },\n        ],\n      },\n      domainList: {}, //工作区域列表\n      backPage: \"\", //返回地址\n      nodeEnv: process.env.NODE_ENV, //当前运行环境\n    };\n  },\n  computed: {\n    // 过滤后展示的工位点位列表\n    spots() {\n      return this.Vertex.filter(({ vertexPo }) => {\n        var str = this.spotFilter.toLowerCase();\n        return (\n          (String(vertexPo.id).indexOf(str) > -1 ||\n            vertexPo.alias.toLowerCase().indexOf(str) > -1 ||\n            vertexPo.code.toLowerCase().indexOf(str) > -1) &&\n          vertexPo.type !== 0\n        );\n      });\n    },\n  },\n  mounted() {\n    this.getMapDetailById();\n    this.onResize();\n    // 获取工作区域列表\n    getDomainList().then((res) => {\n      if (res.state && res.data.data) {\n        res.data.data.forEach((item) => {\n          this.$set(this.domainList, item.id, item.name);\n        });\n      }\n    });\n    this.backPage = this.$route.query.backPage;\n  },\n  methods: {\n    onResize() {\n      this.$nextTick(() => {\n        document.getElementById(\"imageChild\").style.maxWidth =\n          this.$refs.imageParent.offsetWidth - 80 + \"px\";\n        document.getElementById(\"imageChild\").style.maxHeight =\n          this.$refs.imageParent.offsetHeight - 50 + \"px\";\n      });\n    },\n    // 获取地图详情\n    getMapDetailById() {\n      this.loading = true;\n      getMapDetails({ mapId: this.$route.params.id }).then((res) => {\n        this.loading = false;\n        if (res.state) {\n          let { Edge, Vertex, area, topologyMap } = res.data;\n          this.Edge = Edge;\n          this.Vertex = Vertex;\n          this.area = area;\n          this.topologyMap = topologyMap;\n          this.step = topologyMap.enable ? 3 : 1;\n          this.pngSrc =\n            (process.env.NODE_ENV === \"development\" ? \"/api/\" : \"\") +\n            topologyMap.backgroundImgUrl.replace(/\\\\/g, \"/\");\n        }\n      });\n    },\n    // 切换启用/禁用\n    toggleEnable() {\n      let msg = this.topologyMap.enable === 1 ? \"启用\" : \"禁用\";\n      let fun = () => {\n        this.topologyMap.enable = this.topologyMap.enable === 1 ? 0 : 1;\n      };\n      this.$confirm(\n        `确定${msg}${this.topologyMap.alias || this.topologyMap.name}?`,\n        \"提示\",\n        {\n          confirmButtonText: \"确定\",\n          cancelButtonText: \"取消\",\n          type: \"warning\",\n        }\n      )\n        .then(() => {\n          updateMap(this.topologyMap).then((res) => {\n            if (res.state) {\n              this.$message.success(`地图${msg}成功`);\n              this.getMapDetailById();\n            } else {\n              fun();\n            }\n          });\n        })\n        .catch(() => {\n          fun();\n        });\n    },\n    // 打开编辑地图弹框\n    openEditDialog() {\n      this.mapForm = JSON.parse(JSON.stringify(this.topologyMap));\n      this.isDialog = true;\n    },\n    // 关闭弹框\n    closeDialog() {\n      this.$refs.mapForm.clearValidate();\n      this.isDialog = false;\n    },\n    // 保存修改弹框\n    saveEdit() {\n      this.$refs.mapForm.validate((valid) => {\n        if (valid) {\n          updateMap(this.mapForm).then((res) => {\n            if (res.state) {\n              Message.success(\"地图修改成功\");\n              this.isDialog = false;\n              this.getMapDetailById();\n            }\n          });\n        }\n      });\n    },\n    // 删除地图\n    deleteMap() {\n      if (this.topologyMap.enable) return Message.warning(\"请先禁用该地图\");\n      MessageBox.confirm(\n        `确定删除地图: ${this.topologyMap.alias || this.topologyMap.name}?`,\n        \"提示\",\n        {\n          confirmButtonText: \"确定\",\n          cancelButtonText: \"取消\",\n          type: \"warning\",\n        }\n      )\n        .then(() => {\n          deleteMap(this.topologyMap.id).then((res) => {\n            if (res.state) {\n              Message.success(\"地图删除成功\");\n              this.$router.push(\"/map/index\");\n            }\n          });\n        })\n        .catch(() => {});\n    },\n    // 返回来源页面\n    goBack() {\n      this.$router.push(this.backPage);\n    },\n  },\n};\n</script>\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\n.mapDetails-container {\n  .content-box {\n    position: relative;\n    background-color: #fff;\n    border-radius: 5px;\n  }\n  .step-main {\n    padding: 40px 200px;\n    margin: 0 auto 10px;\n    .step-title {\n      position: absolute;\n      top: 10px;\n      left: 10px;\n      font-weight: 500;\n      font-size: 16px;\n    }\n  }\n  .spot-map-main {\n    display: flex;\n    .spot-main {\n      width: 30%;\n      margin-right: 10px;\n      .spot-filter {\n        display: flex;\n        padding: 10px 20px;\n      }\n    }\n    .map-main {\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n      padding: 20px 30px;\n      .header {\n        display: flex;\n        justify-content: space-between;\n        .title {\n          font-weight: 500;\n          font-size: 20px;\n          color: #409eff;\n        }\n        .buttons {\n          display: flex;\n          align-items: center;\n          .switch {\n            margin-right: 8px;\n          }\n        }\n      }\n      .detail {\n        margin: 20px 40px 0;\n        display: flex;\n        flex-wrap: wrap;\n        div {\n          margin: 10px 30px 0 0;\n          color: #606266;\n        }\n      }\n      .image {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        flex: 1;\n        padding: 40px 40px 0;\n        box-sizing: border-box;\n        img {\n          border-radius: 5px;\n        }\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js??vue-loader-options!./detail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js??vue-loader-options!./detail.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./detail.vue?vue&type=template&id=1f732eb6&scoped=true&\"\nimport script from \"./detail.vue?vue&type=script&lang=js&\"\nexport * from \"./detail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./detail.vue?vue&type=style&index=0&id=1f732eb6&rel=stylesheet%2Fscss&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.7@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1f732eb6\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request'\n\n// 获取地图列表\nexport function getMapList(data) {\n  return request.get('/map/mapList', data)\n}\n\n// 修改地图\nexport function updateMap(data) {\n  return request.post('/map/updateMap', data)\n}\n\n// 删除地图\nexport function deleteMap(id) {\n  return request.post('/map/delete/' + id)\n}\n\n// 获取地图详情\nexport function getMapDetails(data) {\n  return request.get('/map/getMapDetailById', data)\n}","export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/_vue-loader@15.9.7@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/_sass-loader@7.3.1@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js??vue-loader-options!./detail.vue?vue&type=style&index=0&id=1f732eb6&rel=stylesheet%2Fscss&lang=scss&scoped=true&\""],"sourceRoot":""}