(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-436522cf"],{"0115":function(t,e,i){"use strict";i.d(e,"g",(function(){return n})),i.d(e,"f",(function(){return s})),i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return c})),i.d(e,"d",(function(){return d})),i.d(e,"h",(function(){return l})),i.d(e,"e",(function(){return u}));var a=i("b775");function n(){return a["a"].get("/chargePile/model/findAll")}function s(t){return a["a"].post("/chargePile/page",t)}function r(t){return a["a"].post("/chargePile/add",t)}function o(t){var e=t.id,i=t.enable;return a["a"].get("/chargePile/enable?id="+e+"&state="+i)}function c(t){var e=t.id,i=t.modelId;return a["a"].get("chargePile/bindModel?id="+e+"&modelId="+i)}function d(t){return a["a"].get("/chargePile/delete?id="+t)}function l(t){return a["a"].get("/map/getMapVertexes/"+t)}function u(t){return a["a"].post("chargePile/history/detail",t)}},"0aa6":function(t,e,i){"use strict";i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return r})),i.d(e,"d",(function(){return o})),i.d(e,"b",(function(){return c}));var a=i("b775"),n=i("5f87");function s(t){return t||(t={}),t.userId=Object(n["c"])(),a["a"].get("/group/list",t)}function r(t){return a["a"].post("/group/addOrUpdate",t)}function o(t){return a["a"].post("/group/addOrUpdate",t)}function c(t){return a["a"].delete("/group/delete/"+t)}},"16ad":function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));i("304d"),i("f257"),i("89a8"),i("2478"),i("b110"),i("fe35");function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}},2840:function(t,e,i){"use strict";i.d(e,"c",(function(){return n})),i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return r})),i.d(e,"d",(function(){return o})),i.d(e,"e",(function(){return c}));i("b3d9");var a=i("b775");function n(t){return a["a"].post("/area/list",t)}function s(t){return a["a"].post("/area/update",t)}function r(t){return a["a"].post("/area/delete/"+t)}function o(){return a["a"].get("rest/forcedArea/getRestForcedAreaList")}function c(t){var e=t.areaId,i=t.enable;return a["a"].put("rest/forcedArea/addOrUpdate/".concat(e,"/").concat(i))}},"41c2":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.isStartEdit?i("span",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"device/amr/update",expression:"'device/amr/update'"}]},[i("i",{staticClass:"el-icon-check check",on:{click:t.checkEdit}}),i("i",{staticClass:"el-icon-close close",on:{click:t.closeEdit}})]):i("span",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"device/amr/update",expression:"'device/amr/update'"}]},[i("i",{staticClass:"el-icon-edit edit",on:{click:t.startEdit}})])},n=[],s=i("16ad"),r=(i("87d5"),i("1926"),{props:["isEdit","data","directUpdate"],data:function(){return{oldDataCopy:""}},computed:{editData:{get:function(){return this.data},set:function(t){this.$emit("update:data",t)}},isStartEdit:{get:function(){return this.isEdit},set:function(t){this.$emit("update:isEdit",t)}}},methods:{startEdit:function(){this.$emit("closeAll"),this.isStartEdit=!0,"object"===Object(s["a"])(this.editData)?this.oldDataCopy=JSON.parse(JSON.stringify(this.editData)):this.oldDataCopy=this.editData,this.$emit("open")},closeEdit:function(){this.isStartEdit=!1,this.editData=this.oldDataCopy,this.$emit("cancel")},checkEdit:function(){if(this.directUpdate)return this.$emit("checkEdit",this.editData);Array.isArray(this.editData)?this.editData.join(",")!==this.oldDataCopy.join(",")?this.$emit("checkEdit",this.editData):this.isStartEdit=!1:this.editData!==this.oldDataCopy?this.$emit("checkEdit",this.editData):this.isStartEdit=!1}}}),o=r,c=(i("c4c4"),i("cba8")),d=Object(c["a"])(o,a,n,!1,null,"72e45d5f",null);e["default"]=d.exports},"49c1":function(t,e,i){"use strict";i("760e")},"4b54":function(t,e,i){},"760e":function(t,e,i){},7661:function(t,e,i){"use strict";i.d(e,"c",(function(){return n})),i.d(e,"d",(function(){return s})),i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return o}));var a=i("b775");function n(t){return a["a"].get("/map/mapList",t)}function s(t){return a["a"].post("/map/updateMap",t)}function r(t){return a["a"].post("/map/delete/"+t)}function o(t){return a["a"].get("/map/getMapDetailById",t)}},"7cf8":function(t,e,i){"use strict";i.d(e,"d",(function(){return n})),i.d(e,"e",(function(){return s})),i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return o})),i.d(e,"g",(function(){return c})),i.d(e,"h",(function(){return d})),i.d(e,"f",(function(){return l})),i.d(e,"c",(function(){return u}));var a=i("b775");function n(t){return a["a"].get("/amr/onlineAmr",t)}function s(t){return a["a"].get("/amr/getOnlineAmrById",t)}function r(){return a["a"].post("/area/monitor")}function o(t){return a["a"].get("/amr/getAmrTaskById",t)}function c(t){return a["a"].post("/amr/taskCommand/pause/"+t.id)}function d(t){return a["a"].post("/amr/taskCommand/resume/"+t.id)}function l(t){return a["a"].get("map/loadMapFileByAmr",t,"blob")}function u(){return a["a"].get("dispatch/vehicle/getActiveVehicles")}},"9df5":function(t,e,i){"use strict";i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return s})),i.d(e,"d",(function(){return r})),i.d(e,"b",(function(){return o}));var a=i("b775");function n(t){return a["a"].post("rest/station/list",t)}function s(t){return a["a"].post("rest/station/add",t)}function r(t){return a["a"].post("rest/station/update",t)}function o(t){return a["a"].delete("rest/station/delete/"+t)}},a215:function(t,e,i){"use strict";i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return s})),i.d(e,"d",(function(){return r})),i.d(e,"b",(function(){return o}));i("b3d9");var a=i("b775");function n(t){return a["a"].post("/amrChargeConfig/list",t)}function s(t){return a["a"].post("/amrChargeConfig/add",t)}function r(t){return a["a"].post("/amrChargeConfig/update",t)}function o(t){var e=t.id,i=t.uuid;return a["a"].delete("/amrChargeConfig/delete/".concat(e,"/").concat(i))}},c4c4:function(t,e,i){"use strict";i("4b54")},fbb2:function(t,e,i){"use strict";i.d(e,"h",(function(){return n})),i.d(e,"j",(function(){return s})),i.d(e,"a",(function(){return r})),i.d(e,"n",(function(){return o})),i.d(e,"l",(function(){return c})),i.d(e,"c",(function(){return d})),i.d(e,"g",(function(){return l})),i.d(e,"o",(function(){return u})),i.d(e,"q",(function(){return f})),i.d(e,"r",(function(){return h})),i.d(e,"p",(function(){return m})),i.d(e,"e",(function(){return p})),i.d(e,"i",(function(){return g})),i.d(e,"b",(function(){return I})),i.d(e,"s",(function(){return v})),i.d(e,"d",(function(){return b})),i.d(e,"m",(function(){return E})),i.d(e,"f",(function(){return C})),i.d(e,"k",(function(){return P}));var a=i("b775");function n(t){return a["a"].post("/amr/getAmrPageList",t)}function s(){return a["a"].get("/amr/listAmrType")}function r(t){return a["a"].post("/amr/register",t)}function o(t){return a["a"].post("/amr/editorAmr",t)}function c(t){return a["a"].get("/amr/enable",t)}function d(t){return a["a"].post("/amr/deleteAmr/"+t)}function l(t){return a["a"].get("/amr/getDetailAmr",t)}function u(t){return a["a"].get("/amr/updateArea",t)}function f(t){return a["a"].get("/amr/updateGroup",t)}function h(t){return a["a"].get("chargeConf/update/amrAdaptation",t)}function m(t){return a["a"].get("chargeConf/update/amrBind",t)}function p(t){return a["a"].get("chargeConf/bind/force",t)}function g(t){return a["a"].get("rest/config/find",t)}function I(t){return a["a"].post("rest/config/add",t)}function v(t){return a["a"].post("rest/config/update",t)}function b(t){return a["a"].get("rest/config/delete",t)}function E(t){return a["a"].get("amr/unRegister",t)}function C(t){return a["a"].get("traffic/locked/find",t)}function P(t){return a["a"].get("traffic/locked/release",t)}},fed2:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"amrDetails-container"},[i("div",{staticClass:"left"},[i("div",{staticClass:"basic"},[t.backPage?i("el-page-header",{on:{back:t.goBack}},[i("template",{slot:"content"},[t._v(" "+t._s(t.amrInfo.amrPo.name?t.amrInfo.amrPo.name+" "+t.amrInfo.amrTypePo.name:"---")+" ")])],2):t._e(),i("div",{ref:"imageParent",staticClass:"image"},[i("img",{attrs:{src:t.imgUrl,id:"imageChild"},on:{error:t.setDefaultImg}})]),i("div",{staticClass:"info-items"},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"info-key"},[t._v("设备ID:")]),i("div",[t._v(t._s(t.amrInfo.amrPo.id))])])])],1),i("div",{staticClass:"function-container"},[i("div",{staticClass:"title"},[t._v("常用功能")]),i("div",{staticClass:"items"},[i("div",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:"device/amr/add",expression:"'device/amr/add'"}],staticClass:"item",on:{click:t.toAddDevice}},[i("i",{staticClass:"el-icon-folder-add"}),i("span",[t._v("添加设备")])]),i("div",{staticClass:"item",on:{click:t.toDeviceList}},[i("i",{staticClass:"el-icon-folder-opened"}),i("span",[t._v("设备列表")])])])])]),i("div",{staticClass:"right"},[i("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleTabClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{style:{height:t.innerHeight-121+"px"},attrs:{name:"1",label:"参数配置"}},[i("div",{staticClass:"title"},[t._v("基础参数")]),i("table",{staticClass:"table",attrs:{border:"1",cellspacing:"0"}},[i("tr",{class:t.isEditName?"tr-editor":""},[i("td",{staticClass:"td-left"},[t._v("设备名称")]),i("td",{staticClass:"td-center"},[t.isEditName?i("el-input",{attrs:{placeholder:"请输入设备名称",clearable:"",maxlength:30},model:{value:t.amrInfo.amrPo.name,callback:function(e){t.$set(t.amrInfo.amrPo,"name","string"===typeof e?e.trim():e)},expression:"amrInfo.amrPo.name"}}):i("span",[t._v(t._s(t.amrInfo.amrPo.name))])],1),i("td",{staticClass:"td-right"},[i("edit-icon",{attrs:{isEdit:t.isEditName,data:t.amrInfo.amrPo.name},on:{"update:isEdit":function(e){t.isEditName=e},"update:is-edit":function(e){t.isEditName=e},"update:data":function(e){return t.$set(t.amrInfo.amrPo,"name",e)},checkEdit:t.updateVehicleName,closeAll:t.closeAll}})],1)]),i("tr",{class:t.isEditArea?"tr-editor":""},[i("td",{staticClass:"td-left"},[t._v("所在区域")]),i("td",{staticClass:"td-center"},[t.isEditArea?i("el-select",{attrs:{placeholder:"请选择工作区域",filterable:""},model:{value:t.amrInfo.amrPo.areaId,callback:function(e){t.$set(t.amrInfo.amrPo,"areaId","string"===typeof e?e.trim():e)},expression:"amrInfo.amrPo.areaId"}},t._l(t.domainList,(function(t,e){return i("el-option",{key:e,attrs:{label:t,value:Number(e)}})})),1):i("span",[t._v(t._s(t.domainList[t.amrInfo.amrPo.areaId]))])],1),i("td",{staticClass:"td-right"},[i("edit-icon",{attrs:{isEdit:t.isEditArea,data:t.amrInfo.amrPo.areaId},on:{"update:isEdit":function(e){t.isEditArea=e},"update:is-edit":function(e){t.isEditArea=e},"update:data":function(e){return t.$set(t.amrInfo.amrPo,"areaId",e)},checkEdit:t.updateVehicleArea,closeAll:t.closeAll}})],1)]),i("tr",{class:t.isEditGroup?"tr-editor":""},[i("td",{staticClass:"td-left"},[t._v("设备分组")]),i("td",{staticClass:"td-center"},[t.isEditGroup?i("el-select",{attrs:{placeholder:"请选择分组",filterable:"",clearable:""},model:{value:t.amrInfo.amrPo.groupId,callback:function(e){t.$set(t.amrInfo.amrPo,"groupId","string"===typeof e?e.trim():e)},expression:"amrInfo.amrPo.groupId"}},t._l(t.groupList,(function(t,e){return i("el-option",{key:e,attrs:{label:t,value:Number(e)}})})),1):i("span",[t._v(t._s(t.groupList[t.amrInfo.amrPo.groupId]||"-- 未绑定 --"))])],1),i("td",{staticClass:"td-right"},[i("edit-icon",{attrs:{isEdit:t.isEditGroup,data:t.amrInfo.amrPo.groupId},on:{"update:isEdit":function(e){t.isEditGroup=e},"update:is-edit":function(e){t.isEditGroup=e},"update:data":function(e){return t.$set(t.amrInfo.amrPo,"groupId",e)},checkEdit:t.updateVehicleGroup,open:t.getGroupList,closeAll:t.closeAll}})],1)]),i("tr",[i("td",{staticClass:"td-left"},[t._v("Mac地址")]),i("td",{staticClass:"td-center"},[i("span",[t._v(t._s(t.amrInfo.amrPo.macAddress))])]),i("td",{staticClass:"td-right"})]),i("tr",[i("td",{staticClass:"td-left"},[t._v("IP地址")]),i("td",{staticClass:"td-center"},[i("span",[t._v(t._s(t.onlineInfo.ip||"--- 未知 ---"))])]),i("td",{staticClass:"td-right"})]),i("tr",{class:t.isEditEnable?"tr-editor":""},[i("td",{staticClass:"td-left"},[t._v("设备状态")]),i("td",{staticClass:"td-center"},[t.isEditEnable?i("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.amrInfo.amrPo.enable,callback:function(e){t.$set(t.amrInfo.amrPo,"enable","string"===typeof e?e.trim():e)},expression:"amrInfo.amrPo.enable"}}):i("span",[t._v(t._s(t.amrInfo.amrPo.enable?"已启用":"未启用"))])],1),i("td",{staticClass:"td-right"},[i("edit-icon",{attrs:{isEdit:t.isEditEnable,data:t.amrInfo.amrPo.enable},on:{"update:isEdit":function(e){t.isEditEnable=e},"update:is-edit":function(e){t.isEditEnable=e},"update:data":function(e){return t.$set(t.amrInfo.amrPo,"enable",e)},checkEdit:t.updateVehicleEnable,closeAll:t.closeAll}})],1)])]),i("div",{staticClass:"title"},[t._v("配置信息")]),i("table",{staticClass:"table",attrs:{border:"1",cellspacing:"0"}},[i("tr",{class:t.isEditModel?"tr-editor":""},[i("td",{staticClass:"td-left"},[t._v("充电桩类型")]),i("td",{staticClass:"td-center"},[t.isEditModel?i("el-select",{attrs:{placeholder:"请选择充电桩类型",filterable:"",clearable:"",multiple:"","collapse-tags":""},model:{value:t.amrInfo.modelIds,callback:function(e){t.$set(t.amrInfo,"modelIds","string"===typeof e?e.trim():e)},expression:"amrInfo.modelIds"}},t._l(t.modelList,(function(t,e){return i("el-option",{key:e,attrs:{label:t,value:Number(e)}})})),1):i("span",[t._v(t._s(t.amrInfo.modelNames))])],1),i("td",{staticClass:"td-right"},[i("edit-icon",{attrs:{isEdit:t.isEditModel,data:t.amrInfo.modelIds},on:{"update:isEdit":function(e){t.isEditModel=e},"update:is-edit":function(e){t.isEditModel=e},"update:data":function(e){return t.$set(t.amrInfo,"modelIds",e)},checkEdit:t.updateVehicleModel,closeAll:t.closeAll}})],1)]),i("tr",{class:t.isEditCharge?"tr-editor":""},[i("td",{staticClass:"td-left"},[t._v("充电桩绑定")]),i("td",{staticClass:"td-center"},[t.isEditCharge?i("span",[i("el-select",{attrs:{placeholder:"请选择充电桩",filterable:"",clearable:"",size:"small"},model:{value:t.amrInfo.charge,callback:function(e){t.$set(t.amrInfo,"charge","string"===typeof e?e.trim():e)},expression:"amrInfo.charge"}},t._l(t.chargePileList,(function(e,a){return i("el-option",{key:a,attrs:{label:t.mapList[e.mapId].name+"/"+e.name,value:Number(a)}})})),1),i("el-switch",{staticClass:"force-bind",model:{value:t.amrInfo.forceBind,callback:function(e){t.$set(t.amrInfo,"forceBind","string"===typeof e?e.trim():e)},expression:"amrInfo.forceBind"}})],1):i("span",[t._v(t._s(t.amrInfo.chargePilePo&&t.mapList[t.amrInfo.chargePilePo.mapId]?t.mapList[t.amrInfo.chargePilePo.mapId].name+"/"+t.amrInfo.chargePilePo.name+"/"+(t.amrInfo.forceBind?"已强制绑定":"未强制绑定"):"-- 未绑定 --"))])]),i("td",{staticClass:"td-right"},[i("edit-icon",{attrs:{isEdit:t.isEditCharge,data:t.amrInfo.charge,directUpdate:!0},on:{"update:isEdit":function(e){t.isEditCharge=e},"update:is-edit":function(e){t.isEditCharge=e},"update:data":function(e){return t.$set(t.amrInfo,"charge",e)},open:t.getChargePileList,checkEdit:t.updateVehicleCharge,closeAll:t.closeAll,cancel:t.getChargeForceBind}})],1)]),i("tr",{class:t.isEditRest?"tr-editor":""},[i("td",{staticClass:"td-left"},[t._v("休息站绑定")]),i("td",{staticClass:"td-center"},[t.isEditRest?i("el-select",{attrs:{placeholder:"请选择休息站",filterable:"",clearable:"",size:"small"},model:{value:t.restInfo.restStationId,callback:function(e){t.$set(t.restInfo,"restStationId","string"===typeof e?e.trim():e)},expression:"restInfo.restStationId"}},t._l(t.restList,(function(t,e){return i("el-option",{key:e,attrs:{label:t.name,value:Number(e)}})})),1):i("span",[t._v(t._s(t.restInfo.restStationId&&t.restStationMap[t.restInfo.restStationId]?t.restStationMap[t.restInfo.restStationId].name:"-- 未绑定 --"))])],1),i("td",{staticClass:"td-right"},[i("edit-icon",{attrs:{isEdit:t.isEditRest,data:t.restInfo.restStationId},on:{"update:isEdit":function(e){t.isEditRest=e},"update:is-edit":function(e){t.isEditRest=e},"update:data":function(e){return t.$set(t.restInfo,"restStationId",e)},open:t.getRestList,checkEdit:t.updateVehicleRest,closeAll:t.closeAll}})],1)]),i("tr",{class:t.isEditRestIdle?"tr-editor":""},[i("td",{staticClass:"td-left"},[t._v("休息时间(s)")]),i("td",{staticClass:"td-center"},[t.isEditRestIdle?i("el-tooltip",{attrs:{content:"清空表示删除休息站配置",placement:"top"}},[i("el-input-number",{attrs:{placeholder:"空闲回休息站时间","controls-position":"right",min:0},model:{value:t.restInfo.idle,callback:function(e){t.$set(t.restInfo,"idle",t._n(e))},expression:"restInfo.idle"}})],1):i("span",[t._v(t._s(t.restInfo.id?t.restInfo.idle:"-- 未配置 --"))])],1),i("td",{staticClass:"td-right"},[i("edit-icon",{attrs:{isEdit:t.isEditRestIdle,data:t.restInfo.idle},on:{"update:isEdit":function(e){t.isEditRestIdle=e},"update:is-edit":function(e){t.isEditRestIdle=e},"update:data":function(e){return t.$set(t.restInfo,"idle",e)},checkEdit:t.updateRestIdle,closeAll:t.closeAll}})],1)]),i("tr",[i("td",{staticClass:"td-left"},[t._v("充电档位")]),i("td",{staticClass:"td-center"},[i("span",[t._v(t._s(t.amrInfo.chargeLevel&&t.amrInfo.chargeLevel.level3?"1档: "+t.amrInfo.chargeLevel.level1+"%, 2档: "+t.amrInfo.chargeLevel.level2+"%, 3档: "+t.amrInfo.chargeLevel.level3+"%":"-- 未设置 --"))])]),i("td",{staticClass:"td-right"},[i("el-button",{attrs:{type:"text"},on:{click:t.setChargeLevel}},[t._v("前往设置")])],1)])])]),i("el-tab-pane",{style:{height:t.innerHeight-121+"px"},attrs:{name:"2",label:"点位资源"}},[i("el-card",{staticClass:"lockedPoints-main",attrs:{header:"已占用点位"}},[i("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("已占用点位")]),i("div",[i("el-button",{attrs:{type:"primary"},on:{click:t.getLockedPoints}},[t._v("手动刷新")]),i("el-button",{attrs:{type:"warning"},on:{click:t.releaseLockedPoints}},[t._v("释放点位")])],1)]),i("div",{staticClass:"point-list"},[t._l(t.lockedPoints,(function(e,a){return i("span",{directives:[{name:"show",rawName:"v-show",value:0!==t.lockedPoints.length,expression:"lockedPoints.length !== 0"}],key:a,staticClass:"point"},[i("el-tag",[t._v(t._s(e))])],1)})),i("span",{directives:[{name:"show",rawName:"v-show",value:0===t.lockedPoints.length,expression:"lockedPoints.length === 0"}],staticClass:"null-data"},[t._v("-- 无占用点位 --")])],2)])],1)],1)],1)])},n=[],s=(i("51b3"),i("89a8"),i("1a91"),i("10dd"),i("304d"),i("f257"),i("1926"),i("5a05"),i("fbb2")),r=i("a215"),o=i("0aa6"),c=i("0115"),d=i("2840"),l=i("7661"),u=i("7cf8"),f=i("9df5"),h=i("41c2"),m=i("5422"),p=i("61f7"),g={props:["innerHeight"],components:{EditIcon:h["default"]},data:function(){return{backPage:"",vehicleId:0,loading:!1,amrInfo:{amrPo:{},amrTypePo:{},chargePileModelPo:[],chargePilePo:"",modelIds:[],modelNames:"",charge:"",chargeLevel:{}},restInfo:{id:"",idle:"",restStationId:""},imgUrl:"./static/img/device/no-img.png",activeName:"1",typeOptions:{},domainList:{},mapList:{},groupList:{},modelList:{},chargePileList:{},restList:{},isEditName:!1,isEditArea:!1,isEditGroup:!1,isEditModel:!1,isEditCharge:!1,isEditEnable:!1,isEditRest:!1,isEditRestIdle:!1,onlineTimer:0,onlineTime:2e3,onlineInfo:{},lockedPoints:[],restStationMap:{}}},mounted:function(){var t=this;this.vehicleId=Number(this.$route.params.id),this.backPage=this.$route.query.backPage,Object(d["c"])().then((function(e){e.state&&e.data.data&&e.data.data.forEach((function(e){t.$set(t.domainList,e.id,e.name)}))})),Object(c["g"])().then((function(e){e.state&&e.data&&e.data.forEach((function(e){t.$set(t.modelList,e.id,e.description)}))})),Object(l["c"])().then((function(e){e.state&&e.data.data&&e.data.data.forEach((function(e){t.$set(t.mapList,e.id,e)}))})),Object(f["c"])().then((function(e){if(e.state){var i=e.data.list||e.data||[];i.forEach((function(e){t.$set(t.restStationMap,e.id,e)}))}})),this.getVehicleRest(),this.getGroupList(),this.getVehicleDetail(),this.handleTabClick(),this.onlineTimer&&clearInterval(this.onlineTimer),this.onlineTimer=setInterval((function(){t.onlineTimer&&t.handleTabClick()}),this.onlineTime),this.onResize()},methods:{handleTabClick:function(){"1"===this.activeName&&this.getOnlineAmrInfo(),"2"===this.activeName&&this.getLockedPoints()},getVehicleDetail:function(){var t=this,e=function(){t.loading=!0,Object(s["g"])({id:t.vehicleId}).then((function(e){if(e.state){var i=e.data,a=i.chargePileModelPo,n=i.chargePilePo,s=[],o="",c="";a&&a.length>0?a.forEach((function(t){s.push(t.id),o+=t.description})):o="-- 未绑定 --",n&&(c=n.id),e.data.modelIds=s,e.data.modelNames=o,e.data.charge=c,t.amrInfo=e.data,Object(r["c"])({amrId:t.vehicleId}).then((function(e){e.state&&t.$set(t.amrInfo,"chargeLevel",e.data.list[0]||{})})),t.getChargeForceBind(),t.imgUrl="./static/img/device/".concat(e.data.amrTypePo.name,".png"),t.loading=!1}}))};this.typeOptions[1]?e():Object(s["j"])().then((function(i){i.state&&i.data&&i.data.forEach((function(e){t.$set(t.typeOptions,e.id,e.name)})),e()}))},getVehicleRest:function(){var t=this;Object(s["i"])({amrId:this.vehicleId}).then((function(e){e.state&&e.data?t.restInfo={id:e.data.id,restStationId:e.data.restStationId,idle:e.data.idle}:t.restInfo={id:"",idle:"",restStationId:""}}))},onResize:function(){var t=this;this.$nextTick((function(){document.getElementById("imageChild").style.maxWidth=t.$refs.imageParent.offsetWidth-80+"px",document.getElementById("imageChild").style.maxHeight=t.$refs.imageParent.offsetHeight-50+"px"}))},getOnlineAmrInfo:function(){var t=this;Object(u["e"])({id:this.vehicleId}).then((function(e){e.state&&(t.onlineInfo=e.data)}))},getGroupList:function(){var t=this;this.groupList={},Object(o["c"])({areaId:this.amrInfo.amrPo.areaId}).then((function(e){e.state&&e.data&&e.data.forEach((function(e){t.$set(t.groupList,e.id,e.groupName)}))}))},getChargePileList:function(){var t=this;if(this.chargePileList={},this.amrInfo.modelIds.length>0){var e={chargeModelIds:this.amrInfo.modelIds,areaId:this.amrInfo.amrPo.areaId};Object(c["f"])(e).then((function(e){e.state&&e.data.data&&e.data.data.forEach((function(e){t.mapList[e.mapId]&&t.domainList[t.mapList[e.mapId].areaId]&&t.$set(t.chargePileList,e.id,e)}))}))}},getRestList:function(){var t=this;this.restList={},Object(f["c"])({areaId:this.amrInfo.amrPo.areaId}).then((function(e){if(e.state){var i=e.data.list||e.data||[];i.forEach((function(e){t.$set(t.restList,e.id,e)}))}})),this.getVehicleRest()},updateVehicleName:function(t){var e=this;if(!t)return m["Message"].warning("设备名称不得为空");var i={id:this.vehicleId,name:t};Object(s["n"])(i).then((function(t){t.state&&(m["Message"].success("设备名称修改成功"),e.isEditName=!1,e.getVehicleDetail())}))},updateVehicleArea:function(t){var e=this,i={id:this.vehicleId,areaId:t};Object(s["o"])(i).then((function(t){t.state&&(m["Message"].success("设备区域修改成功"),e.isEditArea=!1,e.getVehicleDetail())}))},updateVehicleGroup:function(t){var e=this,i={id:this.vehicleId,groupId:t};Object(s["q"])(i).then((function(t){t.state&&(m["Message"].success("设备分组修改成功"),e.isEditGroup=!1,e.getVehicleDetail())}))},updateVehicleEnable:function(t){var e=this,i=1===t?"启用":"禁用",a={id:this.vehicleId,enable:t};Object(s["l"])(a).then((function(t){t.state&&(m["Message"].success("设备".concat(i,"成功")),e.isEditEnable=!1,e.getVehicleDetail())}))},updateVehicleModel:function(t){var e=this,i={amrId:this.vehicleId,adaptation:""};t.length>0&&(i.adaptation=t.join(",")),Object(s["r"])(i).then((function(t){t.state&&(m["Message"].success("设备充电桩类型修改成功"),e.isEditModel=!1,e.getVehicleDetail())}))},updateVehicleCharge:function(t){var e=this,i={amrId:this.vehicleId,isForceBind:this.amrInfo.forceBind};t&&(i.chargePileId=t),Object(s["p"])(i).then((function(t){t.state&&(m["Message"].success("设备充电桩修改成功"),e.isEditCharge=!1,e.getVehicleDetail())}))},updateVehicleRest:function(t){var e=this;if(this.restInfo.id){var i={amrId:this.vehicleId,restStationId:t,idle:this.restInfo.idle,id:this.restInfo.id};Object(s["s"])(i).then((function(t){t.state&&(m["Message"].success("设备休息站配置修改成功"),e.isEditRest=!1,e.getVehicleDetail(),e.getVehicleRest())}))}else{var a={amrId:this.vehicleId,idle:60};t&&(a.restStationId=t),Object(s["b"])(a).then((function(t){t.state&&(m["Message"].success("设备休息站配置成功"),e.isEditRest=!1,e.getVehicleDetail(),e.getVehicleRest())}))}},updateRestIdle:function(t){var e=this;if(this.restInfo.id)if(t||0===t){var i={amrId:this.vehicleId,restStationId:this.restInfo.restStationId,idle:t,id:this.restInfo.id};Object(s["s"])(i).then((function(t){t.state&&(m["Message"].success("空闲回休息站时间修改成功"),e.isEditRestIdle=!1,e.getVehicleDetail(),e.getVehicleRest())}))}else Object(s["d"])({amrId:this.vehicleId}).then((function(t){t.state&&(m["Message"].success("设备已删除绑定休息站"),e.isEditRestIdle=!1,e.getVehicleDetail(),e.getVehicleRest())}));else{if(!t&&0!==t)return;var a={amrId:this.vehicleId,idle:t};Object(s["b"])(a).then((function(t){t.state&&(m["Message"].success("设备休息站配置成功"),e.isEditRestIdle=!1,e.getVehicleDetail(),e.getVehicleRest())}))}},closeAll:function(){this.isEditArea=!1,this.isEditName=!1,this.isEditGroup=!1,this.isEditModel=!1,this.isEditCharge=!1,this.isEditEnable=!1,this.isEditRest=!1,this.isEditRestIdle=!1},goBack:function(){this.$router.push(this.backPage)},toAddDevice:function(){this.$router.push({path:"/device/amr",query:{type:"add",backPage:this.$route.fullPath}})},toDeviceList:function(){this.$router.push({path:"/device/amr",query:{backPage:this.$route.fullPath}})},setChargeLevel:function(){this.$router.push({path:"/config/chargeLevel",query:{amrId:this.vehicleId,backPage:this.$route.fullPath}})},setDefaultImg:function(){this.imgUrl="./static/img/device/no-img.png"},getLockedPoints:function(){var t=this;Object(s["f"])({amrId:this.vehicleId}).then((function(e){e.state&&(t.lockedPoints=e.data.filter((function(t){return!Object(p["b"])(t)})))}))},releaseLockedPoints:function(){var t=this;m["MessageBox"].confirm("确定释放小车占用点位?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["k"])({amrId:t.vehicleId}).then((function(e){e.state&&(m["Message"].success("小车占用点位释放成功"),t.getLockedPoints())}))})).catch((function(){}))},getChargeForceBind:function(){var t=this;Object(s["e"])({amrId:this.vehicleId}).then((function(e){e.state&&t.$set(t.amrInfo,"forceBind",e.data)}))}},beforeDestroy:function(){this.onlineTimer&&clearInterval(this.onlineTimer)}},I=g,v=(i("49c1"),i("cba8")),b=Object(v["a"])(I,a,n,!1,null,"6e3f95f8",null);e["default"]=b.exports}}]);
//# sourceMappingURL=chunk-436522cf.1649302258356.js.map